(this["webpackJsonpdaily-moments"]=this["webpackJsonpdaily-moments"]||[]).push([[1],{118:function(e,t,n){},119:function(e,t,n){"use strict";n.r(t);var a=n(28),r=n(0),l=n.n(r),c=n(33),o=n.n(c),i=n(2),s=n(63),u=n(15),m=n(14),d=n(13),p=n(65),E=(n(103),n(105),n(120),p.initializeApp({apiKey:"AIzaSyAZgWCsMgylVAS9OPh1BBaq7HsKzq9pArQ",authDomain:"daily-moments-aa.firebaseapp.com",databaseURL:"https://daily-moments-aa.firebaseio.com",projectId:"daily-moments-aa",storageBucket:"daily-moments-aa.appspot.com",messagingSenderId:"850545345787",appId:"1:850545345787:web:4eb677b6fdfb8606539c5e"})),f=E.auth(),b=E.firestore(),g=E.storage(),j=l.a.createContext({loggedIn:!1});function v(){return Object(r.useContext)(j)}var y=n(4),h=n.n(y),O=n(12),k=a.c.Camera;function x(e,t){return w.apply(this,arguments)}function w(){return(w=Object(O.a)(h.a.mark((function e(t,n){var a,r,l,c,o;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=g.ref("/users/".concat(n,"/pictures/").concat(Date.now())),e.next=3,fetch(t);case 3:return r=e.sent,e.next=6,r.blob();case 6:return l=e.sent,e.next=9,a.put(l);case 9:return c=e.sent,e.next=12,c.ref.getDownloadURL();case 12:return o=e.sent,console.log("saved picture:",o),e.abrupt("return",o);case 15:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var S=function(){var e=v().userId,t=Object(u.f)(),n=Object(r.useState)(""),c=Object(d.a)(n,2),o=c[0],s=c[1],m=Object(r.useState)(""),p=Object(d.a)(m,2),E=p[0],f=p[1],g=Object(r.useState)("/assets/placeholder.png"),j=Object(d.a)(g,2),y=j[0],w=j[1],S=Object(r.useState)(""),_=Object(d.a)(S,2),I=_[0],C=_[1],A=Object(r.useRef)();Object(r.useEffect)((function(){return function(){y.startsWith("blob:")&&URL.revokeObjectURL(y)}}),[y]);var U=function(){var e=Object(O.a)(h.a.mark((function e(){var t;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!Object(i.J)("capacitor")){e.next=13;break}return e.prev=1,e.next=4,k.getPhoto({resultType:a.a.Uri,source:a.b.Prompt,width:600});case 4:t=e.sent,w(t.webPath),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),console.log("Camera error:",e.t0);case 11:e.next=14;break;case 13:A.current.click();case 14:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(){return e.apply(this,arguments)}}(),L=function(){var n=Object(O.a)(h.a.mark((function n(){var a,r,l;return h.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(a=b.collection("users").doc(e).collection("entries"),r={date:o,title:E,pictureUrl:y,description:I},!y.startsWith("/assets")){n.next=6;break}return n.next=5,x(y,e);case 5:r.pictureUrl=n.sent;case 6:return n.next=8,a.add(r);case 8:l=n.sent,console.log("saved:",l.id),t.goBack();case 11:case"end":return n.stop()}}),n)})));return function(){return n.apply(this,arguments)}}();return l.a.createElement(i.q,null,l.a.createElement(i.i,null,l.a.createElement(i.A,null,l.a.createElement(i.d,{slot:"start"},l.a.createElement(i.b,null)),l.a.createElement(i.z,null,"Add Entry"))),l.a.createElement(i.e,{className:"ion-padding"},l.a.createElement(i.m,null,l.a.createElement(i.n,{position:"stacked"},"Date"),l.a.createElement(i.f,{value:o,onIonChange:function(e){return s(e.detail.value)}})),l.a.createElement(i.o,null,l.a.createElement(i.m,null,l.a.createElement(i.n,{position:"stacked"},"Title"),l.a.createElement(i.l,{value:E,onIonChange:function(e){return f(e.detail.value)}})),l.a.createElement(i.m,null,l.a.createElement(i.n,{position:"stacked"},"Picture"),l.a.createElement("br",null),l.a.createElement("input",{type:"file",accept:"image/*",hidden:!0,ref:A,onChange:function(e){if(e.target.files.length>0){var t=e.target.files.item(0),n=URL.createObjectURL(t);w(n)}}}),l.a.createElement("img",{src:y,alt:"",style:{cursor:"pointer"},onClick:U})),l.a.createElement(i.m,null,l.a.createElement(i.n,{position:"stacked"},"Description"),l.a.createElement(i.x,{value:I,onIonChange:function(e){return C(e.detail.value)}}))),l.a.createElement(i.c,{expand:"block",onClick:L},"Save")))};function _(e){return new Date(e).toLocaleDateString("en-US",{day:"numeric",month:"short",year:"numeric"})}var I=n(66);function C(e){return Object(I.a)({id:e.id},e.data())}var A=function(){var e=v().userId,t=Object(u.f)(),n=Object(u.g)().id,a=Object(r.useState)(),c=Object(d.a)(a,2),o=c[0],s=c[1];Object(r.useEffect)((function(){b.collection("users").doc(e).collection("entries").doc(n).get().then((function(e){return s(C(e))}))}),[e,n]);var p=function(){var a=Object(O.a)(h.a.mark((function a(){var r;return h.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return r=b.collection("users").doc(e).collection("entries").doc(n),a.next=3,r.delete();case 3:t.goBack();case 4:case"end":return a.stop()}}),a)})));return function(){return a.apply(this,arguments)}}();return l.a.createElement(i.q,null,l.a.createElement(i.i,null,l.a.createElement(i.A,null,l.a.createElement(i.d,{slot:"start"},l.a.createElement(i.b,null)),l.a.createElement(i.z,null,_(null===o||void 0===o?void 0:o.date)),l.a.createElement(i.d,{slot:"end"},l.a.createElement(i.c,{onClick:p},l.a.createElement(i.j,{icon:m.q,slot:"icon-only"}))))),l.a.createElement(i.e,{className:"ion-padding"},l.a.createElement("h2",null,null===o||void 0===o?void 0:o.title),l.a.createElement("img",{src:null===o||void 0===o?void 0:o.pictureUrl,alt:null===o||void 0===o?void 0:o.title}),l.a.createElement("p",null,null===o||void 0===o?void 0:o.description)))},U=function(){var e=v().userId,t=Object(r.useState)([]),n=Object(d.a)(t,2),a=n[0],c=n[1];return Object(r.useEffect)((function(){return b.collection("users").doc(e).collection("entries").orderBy("date","desc").limit(7).onSnapshot((function(e){var t=e.docs;return c(t.map(C))}))}),[e]),l.a.createElement(i.q,null,l.a.createElement(i.i,null,l.a.createElement(i.A,null,l.a.createElement(i.z,null,"Daily Moments"))),l.a.createElement(i.e,{className:"ion-padding"},l.a.createElement(i.o,null,a.map((function(e){return l.a.createElement(i.m,{button:!0,key:e.id,routerLink:"/my/entries/view/".concat(e.id)},l.a.createElement(i.y,{slot:"end"},l.a.createElement(i.k,{src:e.pictureUrl})),l.a.createElement(i.n,null,l.a.createElement("h2",null,_(e.date)),l.a.createElement("h3",null,e.title)))}))),l.a.createElement(i.g,{vertical:"bottom",horizontal:"end"},l.a.createElement(i.h,{routerLink:"/my/entries/add"},l.a.createElement(i.j,{icon:m.a})))))},L=function(){return l.a.createElement(i.q,null,l.a.createElement(i.i,null,l.a.createElement(i.A,null,l.a.createElement(i.z,null,"Settings"))),l.a.createElement(i.e,{className:"ion-padding"},l.a.createElement(i.c,{color:"danger",expand:"block",onClick:function(){return f.signOut()}},"LogOut")))},D=function(){return v().loggedIn?l.a.createElement(i.v,null,l.a.createElement(i.s,null,l.a.createElement(u.b,{exact:!0,path:"/my/entries"},l.a.createElement(U,null)),l.a.createElement(u.b,{exact:!0,path:"/my/entries/add"},l.a.createElement(S,null)),l.a.createElement(u.b,{exact:!0,path:"/my/entries/view/:id"},l.a.createElement(A,null)),l.a.createElement(u.b,{exact:!0,path:"/my/settings"},l.a.createElement(L,null))),l.a.createElement(i.t,{slot:"bottom"},l.a.createElement(i.u,{tab:"home",href:"/my/entries"},l.a.createElement(i.j,{icon:m.i}),l.a.createElement(i.n,null,"Home")),l.a.createElement(i.u,{tab:"settings",href:"/my/settings"},l.a.createElement(i.j,{icon:m.p}),l.a.createElement(i.n,null,"Settings")))):l.a.createElement(u.a,{to:"/login"})},P=function(){var e=v().loggedIn,t=Object(r.useState)(""),n=Object(d.a)(t,2),a=n[0],c=n[1],o=Object(r.useState)(""),s=Object(d.a)(o,2),m=s[0],p=s[1],E=Object(r.useState)({loading:!1,error:!1}),b=Object(d.a)(E,2),g=b[0],j=b[1],y=function(){var e=Object(O.a)(h.a.mark((function e(){var t;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,j({loading:!0,error:!1}),e.next=4,f.signInWithEmailAndPassword(a,m);case 4:t=e.sent,console.log("credential:",t),e.next=12;break;case 8:e.prev=8,e.t0=e.catch(0),j({loading:!1,error:!0}),console.log("error:",e.t0);case 12:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(){return e.apply(this,arguments)}}();return e?l.a.createElement(u.a,{to:"/my/entries"}):l.a.createElement(i.q,null,l.a.createElement(i.i,null,l.a.createElement(i.A,null,l.a.createElement(i.z,null,"Login"))),l.a.createElement(i.e,{className:"ion-padding"},l.a.createElement(i.o,null,l.a.createElement(i.m,null,l.a.createElement(i.n,{position:"stacked"},"Email"),l.a.createElement(i.l,{type:"email",value:a,onIonChange:function(e){return c(e.detail.value)}})),l.a.createElement(i.m,null,l.a.createElement(i.n,{position:"stacked"},"Password"),l.a.createElement(i.l,{type:"password",value:m,onIonChange:function(e){return p(e.detail.value)}}))),g.error&&l.a.createElement(i.w,{color:"danger"},"Invalid credentials"),l.a.createElement(i.c,{expand:"block",onClick:y},"Login"),l.a.createElement(i.c,{expand:"block",fill:"clear",routerLink:"/register"},"Don't have an account?"),l.a.createElement(i.p,{isOpen:g.loading})))},N=function(){return l.a.createElement(i.q,null,l.a.createElement(i.e,{className:"ion-padding"},"Page Not Found"))},q=function(){var e=v().loggedIn,t=Object(r.useState)(""),n=Object(d.a)(t,2),a=n[0],c=n[1],o=Object(r.useState)(""),s=Object(d.a)(o,2),m=s[0],p=s[1],E=Object(r.useState)({loading:!1,error:!1}),b=Object(d.a)(E,2),g=b[0],j=b[1],y=function(){var e=Object(O.a)(h.a.mark((function e(){var t;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,j({loading:!0,error:!1}),e.next=4,f.createUserWithEmailAndPassword(a,m);case 4:t=e.sent,console.log("credential:",t),e.next=12;break;case 8:e.prev=8,e.t0=e.catch(0),j({loading:!1,error:!0}),console.log("error:",e.t0);case 12:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(){return e.apply(this,arguments)}}();return e?l.a.createElement(u.a,{to:"/my/entries"}):l.a.createElement(i.q,null,l.a.createElement(i.i,null,l.a.createElement(i.A,null,l.a.createElement(i.z,null,"Register"))),l.a.createElement(i.e,{className:"ion-padding"},l.a.createElement(i.o,null,l.a.createElement(i.m,null,l.a.createElement(i.n,{position:"stacked"},"Email"),l.a.createElement(i.l,{type:"email",value:a,onIonChange:function(e){return c(e.detail.value)}})),l.a.createElement(i.m,null,l.a.createElement(i.n,{position:"stacked"},"Password"),l.a.createElement(i.l,{type:"password",value:m,onIonChange:function(e){return p(e.detail.value)}}))),g.error&&l.a.createElement(i.w,{color:"danger"},"Registration failed"),l.a.createElement(i.c,{expand:"block",onClick:y},"Create Account"),l.a.createElement(i.c,{expand:"block",fill:"clear",routerLink:"/login"},"Already have an account?"),l.a.createElement(i.p,{isOpen:g.loading})))},z=function(){var e=function(){var e=Object(r.useState)({loading:!0}),t=Object(d.a)(e,2),n=t[0],a=t[1];return Object(r.useEffect)((function(){return f.onAuthStateChanged((function(e){var t=e?{loggedIn:!0,userId:e.uid}:{loggedIn:!1};a({loading:!1,auth:t})}))}),[]),n}(),t=e.loading,n=e.auth;return t?l.a.createElement(i.p,{isOpen:!0}):(console.log("rendering App with auth:",n),l.a.createElement(i.a,null,l.a.createElement(j.Provider,{value:n},l.a.createElement(s.a,null,l.a.createElement(u.d,null,l.a.createElement(u.b,{exact:!0,path:"/login"},l.a.createElement(P,null)),l.a.createElement(u.b,{exact:!0,path:"/register"},l.a.createElement(q,null)),l.a.createElement(u.b,{path:"/my"},l.a.createElement(D,null)),l.a.createElement(u.a,{exact:!0,path:"/",to:"/my/entries"}),l.a.createElement(u.b,null,l.a.createElement(N,null)))))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));n(108),n(109),n(110),n(111),n(112),n(113),n(114),n(115),n(116),n(117),n(118);var R=a.c.SplashScreen;o.a.render(l.a.createElement(z,null),document.getElementById("root")),R.hide(),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))},70:function(e,t,n){e.exports=n(119)},76:function(e,t,n){var a={"./ion-action-sheet.entry.js":[122,5],"./ion-alert.entry.js":[123,6],"./ion-app_8.entry.js":[124,7],"./ion-avatar_3.entry.js":[125,18],"./ion-back-button.entry.js":[126,19],"./ion-backdrop.entry.js":[127,43],"./ion-button_2.entry.js":[128,20],"./ion-card_5.entry.js":[129,21],"./ion-checkbox.entry.js":[130,22],"./ion-chip.entry.js":[131,23],"./ion-col_3.entry.js":[132,44],"./ion-datetime_3.entry.js":[133,10],"./ion-fab_3.entry.js":[134,24],"./ion-img.entry.js":[135,45],"./ion-infinite-scroll_2.entry.js":[136,46],"./ion-input.entry.js":[137,25],"./ion-item-option_3.entry.js":[138,26],"./ion-item_8.entry.js":[139,27],"./ion-loading.entry.js":[140,28],"./ion-menu_3.entry.js":[141,29],"./ion-modal.entry.js":[142,8],"./ion-nav_2.entry.js":[143,15],"./ion-popover.entry.js":[144,9],"./ion-progress-bar.entry.js":[145,30],"./ion-radio_2.entry.js":[146,31],"./ion-range.entry.js":[147,32],"./ion-refresher_2.entry.js":[148,11],"./ion-reorder_2.entry.js":[149,17],"./ion-ripple-effect.entry.js":[150,47],"./ion-route_4.entry.js":[151,33],"./ion-searchbar.entry.js":[152,34],"./ion-segment_2.entry.js":[153,35],"./ion-select_3.entry.js":[154,36],"./ion-slide_2.entry.js":[155,48],"./ion-spinner.entry.js":[156,13],"./ion-split-pane.entry.js":[157,49],"./ion-tab-bar_2.entry.js":[158,37],"./ion-tab_2.entry.js":[159,16],"./ion-text.entry.js":[160,38],"./ion-textarea.entry.js":[161,39],"./ion-toast.entry.js":[162,40],"./ion-toggle.entry.js":[163,12],"./ion-virtual-scroll.entry.js":[164,50]};function r(e){if(!n.o(a,e))return Promise.resolve().then((function(){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}));var t=a[e],r=t[0];return n.e(t[1]).then((function(){return n(r)}))}r.keys=function(){return Object.keys(a)},r.id=76,e.exports=r},98:function(e,t,n){var a={"./ion-icon.entry.js":[168,57]};function r(e){if(!n.o(a,e))return Promise.resolve().then((function(){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}));var t=a[e],r=t[0];return n.e(t[1]).then((function(){return n(r)}))}r.keys=function(){return Object.keys(a)},r.id=98,e.exports=r}},[[70,3,4]]]);
//# sourceMappingURL=main.5452713f.chunk.js.map